<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <link rel="alternate icon" type="image/png" href="/img/favicon.ico">
  <title>
    
      使用LLDB 远程调试 安卓native C++ 程序的vscode 配置 |
     
    Blog
  </title>
  
<link rel="stylesheet" href="/css/maoblog.css">

  
<link rel="stylesheet" href="/css/partials/post.css">

  
<link rel="stylesheet" href="/css/partials/comment.css">

  
<link rel="stylesheet" href="/css/partials/search.css">

  
<link rel="stylesheet" href="/css/partials/meta.css">

  
<link rel="stylesheet" href="/css/partials/about.css">

  
<link rel="stylesheet" href="/fontawesome/css/font-awesome.min.css">

  
<link rel="stylesheet" href="/css/zoom.css">

  
<link rel="stylesheet" href="/css/prism.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/css/math/katex.min.css">

<link rel="stylesheet" href="/css/math/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Blog" type="application/atom+xml">
</head>


  <body>
    <div class="body-container">
      <div class="body-main">
        <div class="header-wrapper"><div class="header">
  <a class="logo" href="/">Blog</a>
  <ul class="nav">
    
      
        <li><a href="/">Posts</a></li>
      
    
      
        <li><a href="/tags">Tags</a></li>
      
    
      
        <li><a style="cursor: pointer;" onclick="openSearchBar()">Search</a></li>
      
    
      
        <li><a href="/about">About</a></li>
      
    
    <!-- <li class="site-mode">light</i></li> -->
  </ul>
</div>
<div class="search-bar-container">  
    <div class="search-bar">
        <input id="search-input" value="" class="search-input" autofocus placeholder="Search something..." type="text" onblur="hideSearchBar()" oninput="exportSearchContent()">
    </div>
    <div class="search-output">
        <ul class="search-output-list">
            <!-- 结果列表 -->
            <!-- <span style="padding-left: 3px; margin-left: 3px;">无记录</span> -->
            <li class="Searching">
                <div class="content">
                    Searching...
                </div>
            </li>
        </ul>
        <span style="padding-left: 3px; margin-left: 3px; font-size: 13px;"><em>Powered by <span  onclick="goToLink(this)"><a href="/search.xml" class="search-xml li-link">search.xml</a></span></em></span>
    </div>
</div></div>
        <div class="main-wrapper"><main>
  <div class="main-container">
      <div class="post-details">
          
            <div class="post-title">
              <h1>使用LLDB 远程调试 安卓native C++ 程序的vscode 配置</h1>
            </div>
          
          <div class="post-content">
            <h1 id="使用lldb-远程调试-安卓native-c-程序的vscode-配置"><a class="markdownIt-Anchor" href="#使用lldb-远程调试-安卓native-c-程序的vscode-配置"></a> 使用LLDB 远程调试 安卓native C++ 程序的vscode 配置</h1>
<h2 id="背景"><a class="markdownIt-Anchor" href="#背景"></a> 背景</h2>
<p>我目前使用windows ssh连接到linux 服务器上,对android native C++代码进行编写,编译(因为服务器核心数量多,编译速度快). 目前高版本的NDK如r26等,已经不再对gdbserver 提供支撑, 所以迁移到LLDB调试,也是主流的技术方向.</p>
<h2 id="相关配置"><a class="markdownIt-Anchor" href="#相关配置"></a> 相关配置</h2>
<ol>
<li>安装vscode 插件<br />
CodeLLDB<br />
<img src="https://s2.loli.net/2024/03/11/pFxMIkRtHvYUyBL.png" alt="20240311140633" /></li>
<li>下载NDK<br />
<a target="_blank" rel="noopener" href="https://developer.android.com/ndk/downloads?hl=zh-cn">NDK下载网站链接</a><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://dl.google.com/android/repository/android-ndk-r26c-linux.zip?hl<span class="token operator">=</span>zh-cn
<span class="token function">unzip</span> android-ndk-r26c-linux.zip<span class="token punctuation">\</span>?hl<span class="token punctuation">\</span><span class="token operator">=</span>zh-cn
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>adb 上传lldb-server <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span>  android-ndk-r26c
<span class="token function">find</span> ./ <span class="token parameter variable">-name</span> <span class="token string">"lldb-server"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<img src="https://s2.loli.net/2024/03/11/1X3Hesi5EPVQ9oy.png" alt="20240311141315" /><br />
选取aarch64 版本的lldb-server <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">adb push ./toolchains/llvm/prebuilt/linux-x86_64/lib/clang/17/lib/linux/aarch64/lldb-server /data/local/tmp
adb shell <span class="token string">"chmod +xrw /data/local/tmp/lldb-server"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>启动lldb-server<br />
<code>lldb-server platform --server --listen *:9999</code> 端口可以自己选,不冲突就行</li>
<li>配置vscode 的launch.json 文件<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Remote launch"</span><span class="token punctuation">,</span>
    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"lldb"</span><span class="token punctuation">,</span>
    <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
    <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"$&#123;workspaceFolder&#125;/build/debuggee"</span><span class="token punctuation">,</span> <span class="token comment">// Local path. </span>
    <span class="token property">"initCommands"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"platform select &lt;platform>"</span><span class="token punctuation">,</span> <span class="token comment">// For example: 'remote-linux', 'remote-macosx', 'remote-android', etc.</span>
        <span class="token string">"platform connect connect://&lt;remote_host>:&lt;port>"</span><span class="token punctuation">,</span>
        <span class="token string">"settings set target.inherit-env false"</span><span class="token punctuation">,</span> <span class="token comment">// See note below.</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"env"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"PATH"</span><span class="token operator">:</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span> <span class="token comment">// remote 的path</span>
        <span class="token property">"LD_LIBRARY_PATH"</span><span class="token operator">:</span> <span class="token string">"/data/local/tmp/code"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"args"</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">"/data/local/tmp/code/pose.mnn"</span><span class="token punctuation">,</span>
        <span class="token string">"/data/local/tmp/code/input.png"</span><span class="token punctuation">,</span>
        <span class="token string">"/data/local/tmp/code/out.png"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"breakpointMode"</span><span class="token operator">:</span> <span class="token string">"file"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
有几个点需要注意
<ul>
<li>program 是linux本地的路径,不是在remote手机上的路径</li>
<li>args 是程序运行时的参数,如果需要路径,是remote上的路径</li>
<li>env 配置的是remote上运行的env,比如链接库地址,PATH等</li>
<li>breakpointMode 设置为file就行</li>
</ul>
</li>
</ol>
<h2 id="建议"><a class="markdownIt-Anchor" href="#建议"></a> 建议</h2>
<ul>
<li>如果配置不成功,首先不使用vscode插件,在自己的电脑上命令行能够启动LLDB,LLDB-server和调试native c++程序.</li>
<li>codeLLDB 使用的是自己的lldb,需要检查该lldb能够正常运行和调试<br />
<img src="https://s2.loli.net/2024/03/11/i1LOAze2saZJ6VK.png" alt="20240311142552" /></li>
</ul>

          </div>
          
            <div class="dot-line"></div>
            <div class="post-meta">
              <div class="post-date">
                <i class="fa fa-calendar"></i>&nbsp;&nbsp;<span class="post-date">2024/03/05</span>
              </div>
              <div class="post-tags">
                 
                  
                    <div class="tag-item">
                      <a href="/tags/linux/"><i class="fa fa-tag"></i>&nbsp;&nbsp;linux</a>
                    </div>
                  
                    <div class="tag-item">
                      <a href="/tags/adb/"><i class="fa fa-tag"></i>&nbsp;&nbsp;adb</a>
                    </div>
                  
                    <div class="tag-item">
                      <a href="/tags/LLDB/"><i class="fa fa-tag"></i>&nbsp;&nbsp;LLDB</a>
                    </div>
                  
                    <div class="tag-item">
                      <a href="/tags/android/"><i class="fa fa-tag"></i>&nbsp;&nbsp;android</a>
                    </div>
                  
                    <div class="tag-item">
                      <a href="/tags/Debug/"><i class="fa fa-tag"></i>&nbsp;&nbsp;Debug</a>
                    </div>
                  
                
              </div>
            </div>
          
      </div>
  </div>
</main>

<script src="https://giscus.app/client.js"
        data-repo="maodaisuki/hexo-theme-maoblog"
        data-repo-id="R_kgDOKICkkw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKICkk84CZEWg"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
<!-- 前往 https://giscus.app 获取配置代码 -->


  
<script src="/js/mermaid.min.js"></script>



<script src="/js/zoom/jquery.min.js"></script>


<script src="/js/zoom/bootstrap.min.js"></script>


<script src="/js/zoom/zoom.js"></script>


<script src="/js/maoblog.js"></script>


<script src="/js/prism.js"></script>
</div>
        <div class="footer-wrapper"><footer>
  <div class="footer-container">
    <div class="footer-meta">
      
        <div class="footer-meta-copyright">
          &copy; 2025 mao.
        </div>
      
      
        <div class="footer-meta-licenese">
          Licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC-BY-NC-SA 4.0</a>
        </div>
      
      
        <div class="footer-meta-rss">
          <a href="/atom.xml"><i class="fa fa-rss"></i></a>
        </div>
      
    </div>
  </div>
</footer>
</div>
      </div>
    </div>
  </body>
  <script type="text/javascript">
    var searchXMLPath = "https://weikangqi.github.io" + "/" + "search.xml"
    console.log(searchXMLPath)
  </script>
  
<script src="/js/search/search.js"></script>

</html>